import { useState } from "react";
import sound from './assets/laugh.mp3';
import bobots from './assets/bobots.gif';

let n = 0;
export default function Congratulations(){
    const [text, setText] = useState('');
    const [dots, setDots] = useState('');

    const congrats = ['11010000 10100001 00100000 11010000 10011101 11010000 10111110 11010000 10110010 11010001 10001011 11010000 10111100 00100000 11010000 10010011 11010000 10111110 11010000 10110100 11010000 10111110 11010000 10111100',
        '11010000 10011111 11010000 10111110 11010000 10110111 11010000 10110100 11010001 10000000 11010000 10110000 11010000 10110010 11010000 10111011 11010001 10001111 11010000 10110101 11010000 10111100',
        '11010000 10010110 11010000 10110101 11010000 10111011 11010000 10110000 11010000 10110101 11010000 10111100 00100000 11010001 10000001 11010001 10000111 11010000 10110000 11010001 10000001 11010001 10000010 11010001 10001100 11010001 10001111',
        '11010000 10100010 11010000 10110000 11010000 10111010 00100000 11010001 10000011 11010000 10110110 00100000 11010000 10111000 00100000 11010000 10110001 11010001 10001011 11010001 10000010 11010001 10001100 00101100 00100000 11010000 10111100 11010001 10001011 00100000 11010001 10000001 11010000 10110101 11010000 10111001 11010001 10000111 11010000 10110000 11010001 10000001 00100000 11010000 10111101 11010000 10110101 00100000 11010000 10110111 11010000 10110000 11010001 10000101 11010000 10110010 11010000 10110000 11010001 10000010 11010000 10111000 11010000 10111100 00100000 11010000 10110010 11010000 10110000 11010001 10000001',
        '11010000 10010110 11010000 10110101 11010000 10111011 11010000 10110000 11010000 10110101 11010000 10111100 00100000 11010000 10110010 11010000 10110000 11010000 10111100 00100000 11010000 10110010 11010001 10000001 11010000 10110101 11010000 10110011 11010000 10111110 00100000 11010001 10000001 11010000 10110000 11010000 10111100 11010000 10111110 11010000 10110011 11010000 10111110 00100000 11010000 10111011 11010001 10000011 11010001 10000111 11010001 10001000 11010000 10110101 11010000 10110011 11010000 10111110 00100001',
    ]
    const audio = new Audio(sound);
    
    
    async function Typing(){
        if(n >= congrats.length){n = 1;}
        
        let promise = new Promise((resolve) => {
            setDots('');
            setText('');
            let d = '.';
            audio.play(); 
            n++;
            for(let i = 0; i < 3; i++){
                setTimeout(() => {setDots(d);
                d += '.';}, 1000 * i)
            }       
            setTimeout(() => resolve(setText(congrats[n] +';')), 3000); 
        })
        await promise;
    }

    return(
        <>
            <div className="gif">
                <img src= {bobots} className="gif"></img>
            </div>
            
            <div className="info">
                
                <div id="txt"><h1>Послания роботов</h1>
                <secretmessage_happynewyear></secretmessage_happynewyear>
                <a href="#txt"><button onClick={Typing} className="btn" >Что же скажут роботы?</button></a>
                </div>
                <div className="con" >
                    <p>Консоль нового года</p>
                    </div>
                <div className="inlineDiv" >
                    <p className="method">happyNewYear() is running{dots}</p>
                    <div className="typed_out" >{text}</div>
                </div>
            </div>
  
        </>
    )
}